<div class="contenedor-clinico">
  <div *ngIf="showMessage" class="notification {{messageType}}">
        {{message}}
        <button class="close-btn" (click)="showMessage = false">×</button>
    </div>

  <header class="cabecera-clinica">
    <h1 class="title">Registro de Consulta Temporal</h1>
    <div class="decoracion-azul"></div>
  </header>

  <form class="formulario-clinico" (ngSubmit)="registrarConsulta()">
    <!-- Sección Paciente -->
    <div class="fila-formulario">
      <div class="grupo-campo">
        <label for="id_paciente">Paciente *</label>
        <div *ngIf="cargando" class="mensaje-carga">Cargando lista de pacientes...</div>
        <div *ngIf="error" class="mensaje-error">{{ error }}</div>
        <select id="id_paciente" name="id_paciente" required [attr.disabled]="formData.id_paciente"
          [(ngModel)]="formData.id_paciente">
          <option value="">-- Selecciona un paciente --</option>
          <option *ngFor="let paciente of pacientes" [value]="paciente.id_paciente">
            {{ paciente.nombre_1 }} {{ paciente.nombre_2 || '' }} {{ paciente.apellido_1 }} {{ paciente.apellido_2 || ''
            }} ({{ paciente.id_paciente }})
          </option>
        </select>

      </div>
      <div class="grupo-campo">
        <label for="fecha_consulta">Fecha de la Consulta *</label>
        <input type="date" id="fecha_consulta" name="fecha_consulta" required [(ngModel)]="formData.fecha_consulta">
      </div>
    </div>

    <!-- Sección Información Básica -->
    <div class="fila-formulario">
      <div class="grupo-campo full-width">
        <label for="motivo_consulta">Motivo de la Consulta *</label>
        <textarea id="motivo_consulta" name="motivo_consulta" required
          [(ngModel)]="formData.motivo_consulta"></textarea>
      </div>
    </div>

    <!-- Sección Signos Vitales -->
    <div class="fila-formulario fila-signos-vitales">
      <div class="grupo-campo">
        <label for="peso">Peso (kg)</label>
        <input type="number" step="0.01" id="peso" name="peso" [(ngModel)]="formData.peso">
      </div>
      <div class="grupo-campo">
        <label for="altura">Altura (cm)</label>
        <input type="number" step="0.01" id="altura" name="altura" [(ngModel)]="formData.altura">
      </div>
      <div class="grupo-campo">
        <label for="frecuencia_cardiaca">Frecuencia Cardíaca</label>
        <input type="number" id="frecuencia_cardiaca" name="frecuencia_cardiaca"
          [(ngModel)]="formData.frecuencia_cardiaca">
      </div>
      <div class="grupo-campo">
        <label for="presion_arterial">Presión Arterial</label>
        <input type="text" id="presion_arterial" name="presion_arterial" [(ngModel)]="formData.presion_arterial">
      </div>
    </div>

    <!-- Sección Historial Médico -->
    <div class="fila-formulario">
      <div class="grupo-campo">
        <label for="antecedente">Antecedentes Médicos</label>
        <textarea id="antecedente" name="antecedente" [(ngModel)]="formData.antecedente"></textarea>
      </div>
      <div class="grupo-campo">
        <label for="enfermedades">Enfermedades Actuales</label>
        <textarea id="enfermedades" name="enfermedades" [(ngModel)]="formData.enfermedades"></textarea>
      </div>
    </div>

    <!-- Sección Exámenes -->
    <div class="fila-formulario">
      <div class="grupo-campo full-width">
        <label for="laboratorio">Resultados de Laboratorio</label>
        <textarea id="laboratorio" name="laboratorio" [(ngModel)]="formData.laboratorio"></textarea>
      </div>
    </div>

    <div class="fila-formulario">
      <div class="grupo-campo full-width">
        <label for="examen_fisico">Examen Físico</label>
        <textarea id="examen_fisico" name="examen_fisico" [(ngModel)]="formData.examen_fisico"></textarea>
      </div>
    </div>

    <!-- Sección Diagnóstico y Tratamiento -->
    <div class="fila-formulario">
      <div class="grupo-campo full-width">
        <label for="diagnostico">Diagnóstico</label>
        <textarea id="diagnostico" name="diagnostico" [(ngModel)]="formData.diagnostico"></textarea>
      </div>
    </div>

    <div class="fila-formulario">
      <div class="grupo-campo full-width">
        <label for="plan_terapeutico">Plan Terapéutico</label>
        <textarea id="plan_terapeutico" name="plan_terapeutico" [(ngModel)]="formData.plan_terapeutico"></textarea>
      </div>
    </div>

    <!-- Próxima Cita -->
    <div class="fila-formulario">
      <div class="grupo-campocita">
        <label for="proxima_cita">Próxima Cita *</label>
        <input type="date" id="proxima_cita" name="proxima_cita" required [(ngModel)]="formData.proxima_cita">
      </div>
      <div class="contenedor-botones">
        <button type="submit" class="btn btn-guardar">Guardar Consulta</button>
        <button type="button" class="btn btn-cancelar" (click)="cancelarConsulta()">Cancelar</button>
      </div>
    </div>
  </form>
</div>